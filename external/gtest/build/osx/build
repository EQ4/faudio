#!/bin/bash
git submodule init   external/gtest/source;
git submodule update external/gtest/source;

pushd external/gtest/source;

mkdir -p build \
    && pushd build \
    && cmake .. \
        -DCMAKE_OSX_SYSROOT="/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.7.sdk" \
        -DCMAKE_OSX_DEPLOYMENT_TARGET="10.5" \
        -DCMAKE_OSX_ARCHITECTURES="i386;x86_64" \
    && make \
    && popd \
    && mkdir -p             ../result/include \
    && mkdir -p             ../result/lib \
    && mv build/libgtest.a  ../result/lib \
    && cp -R include/       ../result/include;
echo "Gtest result: $?";
popd;

