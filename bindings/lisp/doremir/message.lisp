(in-package :audio-engine)
(defctype message-address ptr)
(defctype message ptr)
(define-foreign-type message-dispatcher-type () () (:actual-type :pointer))
(define-parse-method message-dispatcher () (make-instance 'message-dispatcher-type))
(defclass message-dispatcher () ((message-dispatcher-ptr :initarg :message-dispatcher-ptr)))
(defmethod translate-to-foreign (x (type message-dispatcher-type)) (slot-value x 'message-dispatcher-ptr))
(defmethod translate-from-foreign (x (type message-dispatcher-type)) (make-instance 'message-dispatcher :message-dispatcher-ptr x))
(defcfun (message-create-dispatcher "doremir_message_create_dispatcher") message-dispatcher)
(defcfun (message-create-lockfree-dispatcher "doremir_message_create_lockfree_dispatcher") message-dispatcher)
(defcfun (message-destroy-dispatcher "doremir_message_destroy_dispatcher") :void (a message-dispatcher))
(defcfun (message-send "doremir_message_send") :void (a message-address) (b message) (c message-dispatcher))
(defcfun (message-fetch "doremir_message_fetch") list (a message-address) (b message-dispatcher))
(defcfun (message-sync "doremir_message_sync") :void (a message-dispatcher))
(defcfun (message-query "doremir_message_query") list (a message-address) (b message-dispatcher))