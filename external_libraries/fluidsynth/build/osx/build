#!/bin/bash
git submodule init   external_libraries/fluidsynth/source;
git submodule update external_libraries/fluidsynth/source;

pushd external_libraries/fluidsynth/source;
mkdir -p build;
pushd build;

cmake ..                                           \
        -DCMAKE_BUILD_TYPE=Release                 \
        -DCMAKE_OSX_ARCHITECTURES="i386"           \
        -DCMAKE_INSTALL_PREFIX="../../result"      \
        -Denable-aufile=OFF                        \
        -Denable-coreaudio=OFF                     \
        -Denable-coremidi=OFF                      \
        -Denable-dbus=OFF                          \
        -Denable-debug=OFF                         \
        -Denable-fpe-check=OFF                     \
        -Denable-jack=OFF                          \
        -Denable-ladspa=OFF                        \
        -Denable-libsndfile=OFF                    \
        -Denable-midishare=OFF                     \
        -Denable-portaudio=OFF                     \
        -Denable-profiling=OFF                     \
        -Denable-pulseaudio=OFF                    \
        -Denable-readline=OFF                      \
        -Denable-floats=OFF                        \
        -Denable-trap-on-fpe=OFF                   \
        -Denable-framework=OFF                     \
        -DFRAMEWORK_INSTALL_DIR="Frameworks"       \
    && make \
    && make install;

# TODO use install_name_tool to fix dependency on glib


popd;
popd;
